appshot "<%= @appshot_name %>" do
  <% if @database_type == "mongodb" %>
    # Signalled db port: <%= @database_port %>
  <%= @database_type %> port: <%= @database_port || 27017 %><%= ", command_name: #{@database_command}" if @database_command %>
  <% elsif @database_type == "redis" %>
    <%= @database_type %> <%= "command_name: #{@database_command}" if @database_command %><%= ", " if (@database_command && @save_before_snapshot)%><% "save_before_snapshot: #{@save_before_snapshot}" if @save_before_snapshot %>
  <% end %>
  <% if @filesystem_mountpoint %>
  xfs mount_point: "<%= @filesystem_mountpoint %>"
  <% end %>
  ebs_snapshot volume_id: "<%= node['appshot']['storage_volume_id'] %>", aws_access_key_id: "<%= @aws_access_key_id %>", aws_secret_access_key: "<%= @aws_secret_access_key %>"
  <% if @snapshots_to_keep %>
  ebs_prune volume_id: "<%= node['appshot']['storage_volume_id'] %>", snapshots_to_keep: <%= @snapshots_to_keep %>, minimum_retention_days: <%= @minimum_retention_days %>, aws_access_key_id: "<%= @aws_access_key_id %>", aws_secret_access_key: "<%= @aws_secret_access_key %>"
  <% end %>
end
